(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0b5da5"],{"1b53":function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("form",{attrs:{action:"javascript:void(0)"},on:{submit:function(e){return t.billSubmit()}}},[s("div",{staticClass:"vx-row"},[s("div",{staticClass:"vx-col md:w-4/4 w-full mb-base"},[s("vx-card",{attrs:{title:t.$t("SelectDate"),icon:"CalendarIcon"}},[s("b-field",[s("b-datepicker",{attrs:{placeholder:"คลิกเพื่อเลือกวันที่...",icon:"calendar-today","trap-focus":"",rounded:"",size:"is-small"},model:{value:t.billDate,callback:function(e){t.billDate=e},expression:"billDate"}})],1),s("br"),s("b-field",[s("b-switch",{attrs:{size:"is-small",type:"is-info"},model:{value:t.loopDate,callback:function(e){t.loopDate=e},expression:"loopDate"}},[t._v("\n\t\t\t\t\t\t\t\tเรียงวันที่\n\t\t\t\t\t\t\t")])],1)],1)],1),s("div",{staticClass:"vx-col md:w-4/4 w-full mb-base"},[s("vx-card",{attrs:{title:t.$t("SelectProduct"),icon:"CheckCircleIcon"}},[s("b-table",{attrs:{data:t.stockData,loading:t.stockFetching,paginated:t.stockisPaginated,"per-page":t.stockperPage,"current-page":t.stockcurrentPage,"pagination-simple":t.stockisPaginationSimple,"pagination-position":t.stockpaginationPosition,"default-sort-direction":t.stockdefaultSortDirection,"sort-icon":t.stocksortIcon,"sort-icon-size":t.stocksortIconSize,"aria-next-label":"Next page","aria-previous-label":"Previous page","aria-page-label":"Page","aria-current-label":"Current page"},on:{"update:currentPage":function(e){t.stockcurrentPage=e},"update:current-page":function(e){t.stockcurrentPage=e}},scopedSlots:t._u([{key:"default",fn:function(e){return[t._l(t.stock_columns,(function(i){return[s("b-table-column",t._b({key:i.stock_id,scopedSlots:t._u([{key:"searchable",fn:function(e){return i.searchable?[s("b-input",{attrs:{placeholder:"ค้นหาข้อมูล",icon:"magnify",size:"is-small"},model:{value:e.filters[e.column.field],callback:function(s){t.$set(e.filters,e.column.field,s)},expression:"props.filters[props.column.field]"}})]:void 0}}],null,!0)},"b-table-column",i,!1),["index"===i.field?s("span",[s("b-tag",{attrs:{rounded:"",type:"is-light"}},[t._v(t._s(e.index+1))])],1):"options"===i.field?s("span",[s("div",{staticClass:"block"},[s("b-checkbox",{attrs:{type:"is-info","native-value":e.row},model:{value:t.stockGroup,callback:function(e){t.stockGroup=e},expression:"stockGroup"}})],1)]):"stock_name"===i.field?s("span",{staticClass:"th-font"},[s("b-input",{attrs:{disabled:"",value:e.row.stock_name,placeholder:"กรุณาแก้ไขข้อมูล",icon:"pencil",size:"is-small"}})],1):"type_name"===i.field?s("span",{staticClass:"th-font"},[s("b-input",{attrs:{disabled:"",value:e.row.type_name,placeholder:"กรุณาแก้ไขข้อมูล",icon:"pencil",size:"is-small"}})],1):"stock_price"===i.field?s("span",{staticClass:"th-font"},[s("b-input",{attrs:{disabled:"",value:e.row.stock_price,placeholder:"กรุณาแก้ไขข้อมูล",icon:"pencil",size:"is-small"}})],1):t._e()])]}))]}}])})],1)],1),0!=t.stockGroup.length?s("div",{staticClass:"vx-col md:w-4/4 w-full mb-base"},[s("vx-card",{attrs:{title:t.$t("SelectedProduct")+" (บิลรวม "+t.currentBillPrice+" บาท)",icon:"CheckCircleIcon"}},[s("div",{staticClass:"vx-row"},t._l(t.stockGroup,(function(e){return s("div",{key:e.stock_id,staticClass:"vx-col md:w-1/4 w-full mb-base"},[s("b-field",[s("b-input",{attrs:{disabled:"",size:"is-small",type:"text",value:e.stock_name,expanded:""}}),s("b-input",{attrs:{placeholder:"กรุณาใส่จำนวน",icon:"pencil",size:"is-small"},on:{input:function(s){return t.addAmount(e.stock_id,s)}}}),s("p",{staticClass:"control"},[s("button",{staticClass:"button is-danger is-small",on:{click:function(s){return t.removeStock(e.stock_id)}}},[t._v("ลบสินค้า")])])],1)],1)})),0)])],1):t._e(),0!=t.businessGroup.length?s("div",{staticClass:"vx-col md:w-4/4 w-full mb-base"},[s("vx-card",{attrs:{title:t.$t("SelectedBusiness"),icon:"CheckCircleIcon"}},[s("section",t._l(t.businessGroup,(function(e){return s("b-tag",{key:e.business_id,staticStyle:{"margin-right":"5px"},attrs:{rounded:"",type:"is-info",closable:"","aria-close-label":"Close tag"},on:{close:function(s){return t.removeBusiness(e.business_id)}}},[t._v("\n\t\t\t\t\t\t\t\t"+t._s(e.business_name)+"\n\t\t\t\t\t\t\t")])})),1),0!=t.businessGroup.length?s("hr"):t._e(),0!=t.businessGroup.length?s("div",{staticClass:"buttons"},[s("button",{staticClass:"button is-danger is-rounded is-fullwidth is-small",attrs:{type:"submit"},on:{click:function(e){return t.cancelAll()}}},[s("span",{staticClass:"icon",staticStyle:{"margin-right":"3px"}},[s("i",{staticClass:"mdi mdi-close-circle"})]),t._v("\n\t\t\t\t\t\t\t\tยกเลิกทั้งหมด\n\t\t\t\t\t\t\t")])]):t._e()])],1):t._e(),s("div",{staticClass:"vx-col md:w-6/12 w-full mb-base"},[s("vx-card",{attrs:{title:t.$t("SelectBusiness"),icon:"BriefcaseIcon"}},[s("b-table",{attrs:{data:t.businessData,loading:t.businessFetching,paginated:t.isPaginated,"per-page":t.perPage,"current-page":t.currentPage,"pagination-simple":t.isPaginationSimple,"pagination-position":t.paginationPosition,"default-sort-direction":t.defaultSortDirection,"sort-icon":t.sortIcon,"sort-icon-size":t.sortIconSize,"default-sort":"user.first_name","aria-next-label":"Next page","aria-previous-label":"Previous page","aria-page-label":"Page","aria-current-label":"Current page"},on:{"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e}},scopedSlots:t._u([{key:"default",fn:function(e){return[t._l(t.columns,(function(i){return[s("b-table-column",t._b({key:i.id,scopedSlots:t._u([{key:"searchable",fn:function(e){return i.searchable?[s("b-input",{attrs:{placeholder:"ค้นหาข้อมูล",icon:"magnify",size:"is-small"},model:{value:e.filters[e.column.field],callback:function(s){t.$set(e.filters,e.column.field,s)},expression:"props.filters[props.column.field]"}})]:void 0}}],null,!0)},"b-table-column",i,!1),["index"===i.field?s("span",[s("b-tag",{attrs:{rounded:"",type:"is-light"}},[t._v(t._s(e.index+1))])],1):"business_options"===i.field?s("span",[s("div",{staticClass:"block"},[s("b-checkbox",{attrs:{type:"is-info","native-value":e.row},model:{value:t.businessGroup,callback:function(e){t.businessGroup=e},expression:"businessGroup"}})],1)]):"business_name"===i.field?s("span",{staticClass:"th-font"},[s("b-input",{attrs:{disabled:"",value:e.row.business_name,placeholder:"กรุณาแก้ไขข้อมูล",icon:"pencil",size:"is-small"}})],1):t._e()])]}))]}}])})],1)],1),s("div",{staticClass:"vx-col md:w-6/12 w-full mb-base"},[s("vx-card",{attrs:{title:t.$t("BillAmount"),icon:"FileTextIcon"}},[s("b-field",[s("b-numberinput",{attrs:{type:"is-info"},model:{value:t.billLimit,callback:function(e){t.billLimit=e},expression:"billLimit"}})],1),s("b-field",[s("b-slider",{attrs:{lazy:"",type:"is-info"},model:{value:t.billLimit,callback:function(e){t.billLimit=e},expression:"billLimit"}})],1)],1),s("vx-card",{staticStyle:{"margin-top":"15px"},attrs:{title:t.$t("BillStart"),icon:"FileTextIcon"}},[s("b-field",[s("b-numberinput",{attrs:{type:"is-info"},model:{value:t.billStart,callback:function(e){t.billStart=e},expression:"billStart"}})],1),s("b-field",[s("b-slider",{attrs:{lazy:"",type:"is-info"},model:{value:t.billStart,callback:function(e){t.billStart=e},expression:"billStart"}})],1)],1)],1),t._m(0)])])])},n=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"vx-col md:w-12/12 w-full mb-base"},[s("hr"),s("button",{staticClass:"vs-component vs-button vs-button-primary vs-button-filled small",staticStyle:{width:"100%","font-size":"13px"},attrs:{type:"submit",name:"button"}},[s("span",{staticClass:"vs-button-backgroundx vs-button--background",staticStyle:{opacity:"1",left:"20px",top:"20px",width:"0px",height:"0px",transition:"width 0.3s ease 0s, height 0.3s ease 0s, opacity 0.3s ease 0s"}}),s("span",{staticClass:"vs-button-text vs-button--text"},[s("span",{staticClass:"icon",staticStyle:{"margin-right":"3px"}},[s("i",{staticClass:"mdi mdi-check-circle"})]),t._v("\n\t\t\t\t\t\t\tยืนยัน\n\t\t\t\t\t\t")]),s("span",{staticClass:"vs-button-linex",staticStyle:{top:"auto",bottom:"-2px",left:"50%",transform:"translate(-50%)"}})])])}];s("ac6a"),s("6b54"),s("28a5"),s("a481"),s("b047");function a(t){t=o(t);var e=new Array("ศูนย์","หนึ่ง","สอง","สาม","สี่","ห้า","หก","เจ็ด","แปด","เก้า","สิบ"),s=new Array("","สิบ","ร้อย","พัน","หมื่น","แสน","ล้าน"),i="";if(isNaN(t))return"ข้อมูลนำเข้าไม่ถูกต้อง";if(t-0>9999999.9999)return"ข้อมูลนำเข้าเกินขอบเขตที่ตั้งไว้";t=t.split("."),t[1].length>0&&(t[1]=t[1].substring(0,2));for(var n=t[0].length-0,a=0;a<n;a++){var r=t[0].substring(a,a+1)-0;0!=r&&(i+=a==n-1&&1==r?"เอ็ด":a==n-2&&2==r?"ยี่":a==n-2&&1==r?"":e[r],i+=s[n-a-1])}if(i+="บาท","0"==t[1]||"00"==t[1])i+="ถ้วน";else{var l=t[1].length-0;for(a=0;a<l;a++){r=t[1].substring(a,a+1)-0;0!=r&&(i+=a==l-1&&1==r?"เอ็ด":a==l-2&&2==r?"ยี่":a==l-2&&1==r?"":e[r],i+=s[l-a-1])}i+="สตางค์"}return i}function o(t){var e=!1;t=t.toString(),t=t.replace(/ |,|บาท|฿/gi,"");for(var s=0;s<t.length;s++)"."==t[s]&&(e=!0);return 0==e&&(t+=".00"),t}Array.prototype.remove=function(t,e){var s=this.slice((e||t)+1||this.length);return this.length=t<0?this.length+t:t,this.push.apply(this,s)};var r=s("e499"),l=s("4ebb");r.vfs=l.pdfMake.vfs,r.fonts={Kanit:{normal:"Kanit-Regular.ttf"}};var c={data:function(){return{columns:[{field:"index",label:"ลำดับ",width:"50",numeric:!0,searchable:!1,centered:!0},{field:"business_name",label:"ชื่อบริษัท",searchable:!0},{field:"business_options",label:"ตัวเลือก",searchable:!1,centered:!0}],stock_columns:[{field:"index",label:"ลำดับ",width:"50",numeric:!0,searchable:!1,centered:!0},{field:"stock_name",label:"ชื่อสินค้า",searchable:!0},{field:"type_name",label:"ชื่อประเภท",searchable:!0,width:"100"},{field:"stock_price",label:"ราคา",searchable:!0,width:"100"},{field:"options",label:"ตัวเลือก",searchable:!1,centered:!0}],isPaginated:!0,isPaginationSimple:!0,paginationPosition:"bottom",defaultSortDirection:"asc",sortIcon:"arrow-up",sortIconSize:"is-small",currentPage:1,perPage:10,stockisPaginated:!0,stockisPaginationSimple:!0,stockpaginationPosition:"bottom",stockdefaultSortDirection:"asc",stocksortIcon:"arrow-up",stocksortIconSize:"is-small",stockcurrentPage:1,stockperPage:10,businessData:[],businessGroup:[],businessFetching:!0,stockData:[],stockGroup:[],stockFetching:!0,typeData:[],typeFetching:!1,stockType:"",billPrice:0,billLimit:0,billStart:0,billDate:new Date,loopDate:!1,billCurrentDate:new Date,currentTotal:0,currentBillStock:[],currentData:[],currentStock:[],currentAmount:[],currentBillPrice:0,alertMessage:"",alertPosition:"",alertType:"",content:{business_name:"",business_address:"",business_tax:"",business_invoice:"",business_invoice_number:""}}},methods:{billSubmit:function(){if(1==this.loopDate)for(var t=0;t<this.businessGroup.length;t++){this.content.business_name=this.businessGroup[t].business_name,this.content.business_address=this.businessGroup[t].business_address,this.content.business_tax=this.businessGroup[t].business_tax,this.content.business_invoice=this.businessGroup[t].business_invoice,this.currentBillStock.length=0,this.currentTotal=0;for(var e=0;e<this.billLimit;e++){this.billCurrentDate=this.billDate,this.billCurrentDate=this.moment(this.billCurrentDate).add(e,"days").format("DD/MM/YYYY"),this.content.business_invoice_number=+this.billStart+e,this.currentData.length=0,this.currentData.push(["ชื่อสินค้า","หน่วย","จำนวน","ราคา","ราคารวม"]);for(var s=0;s<this.stockGroup.length;s++)for(var i=0;i<this.currentAmount.length;i++)this.stockGroup[s].stock_id==this.currentAmount[i][0]&&this.currentData.push([this.stockGroup[s].stock_name,this.stockGroup[s].unit_name,parseInt(this.currentAmount[i][1]),parseFloat(this.stockGroup[s].stock_price).toFixed(2),parseFloat(this.stockGroup[s].stock_price*this.currentAmount[i][1]).toFixed(2)]);this.generate()}}else if(0==this.loopDate)for(t=0;t<this.businessGroup.length;t++){this.content.business_name=this.businessGroup[t].business_name,this.content.business_address=this.businessGroup[t].business_address,this.content.business_tax=this.businessGroup[t].business_tax,this.content.business_invoice=this.businessGroup[t].business_invoice,this.currentBillStock.length=0,this.currentTotal=0;for(e=0;e<this.billLimit;e++){this.billCurrentDate=this.billDate,this.billCurrentDate=this.moment(this.billCurrentDate).format("DD/MM/YYYY"),this.content.business_invoice_number=+this.billStart+e,this.currentData.length=0,this.currentData.push(["ชื่อสินค้า","หน่วย","จำนวน","ราคา","ราคารวม"]);for(s=0;s<this.stockGroup.length;s++)for(i=0;i<this.currentAmount.length;i++)this.stockGroup[s].stock_id==this.currentAmount[i][0]&&this.currentData.push([this.stockGroup[s].stock_name,this.stockGroup[s].unit_name,parseInt(this.currentAmount[i][1]),parseFloat(this.stockGroup[s].stock_price).toFixed(2),parseFloat(this.stockGroup[s].stock_price*this.currentAmount[i][1]).toFixed(2)]);this.generate()}}},addAmount:function(t,e){this.currentBillPrice=0;for(var s=0;s<this.stockGroup.length;s++)if(this.stockGroup[s].stock_id==t){var i=1;if(0==this.currentAmount.length)this.currentAmount.push([t,e]);else{for(var n=0;n<this.currentAmount.length;n++)if(this.currentAmount[n][0]==t){this.currentAmount[n][1]=e;var a=1}1!=a&&this.currentAmount.push([t,e])}}1!=i&&(this.alertMessage="ขออภัย, กรุณาเลือกสินค้าก่อนค่ะ",this.alertPosition="bottom-right",this.alertType="danger",this.alert());for(n=0;n<this.stockGroup.length;n++)for(var o=0;o<this.currentAmount.length;o++)if(this.stockGroup[n].stock_id==this.currentAmount[o][0]){var r=parseFloat(this.stockGroup[n].stock_price*this.currentAmount[o][1]).toFixed(2);this.currentBillPrice=parseFloat(parseFloat(this.currentBillPrice)+parseFloat(r)).toFixed(2)}console.log(this.currentAmount)},removeBusiness:function(t){for(var e=0;e<this.businessGroup.length;e++)t==this.businessGroup[e].business_id&&this.businessGroup.remove(e)},removeStock:function(t){for(var e=0;e<this.stockGroup.length;e++)t==this.stockGroup[e].stock_id&&this.stockGroup.remove(e);for(var s=0;s<this.currentAmount.length;s++)t==this.currentAmount[s][0]&&this.currentAmount.splice(s,1)},getBusinessAsyncData:function(){var t=this;this.businessData=[],this.businessFetching=!0,this.$http.get("https://gservernodejs.herokuapp.com/api/business/all").then((function(e){var s=e.data;t.businessData=[],"ERROR|EMPTYINFO"!==s&&s.forEach((function(e){return t.businessData.push(e)}))})).catch((function(e){throw t.businessData=[],e})).finally((function(){t.businessFetching=!1}))},getStockAsyncData:function(){var t=this;this.stockData=[],this.stockFetching=!0,this.$http.get("https://gservernodejs.herokuapp.com/api/stock/all").then((function(e){var s=e.data;t.stockData=[],"ERROR|EMPTYINFO"!==s&&s.forEach((function(e){return t.stockData.push(e)}))})).catch((function(e){throw t.stockData=[],e})).finally((function(){t.stockFetching=!1}))},alert:function(){this.$vs.notify({title:"Gentax",text:this.alertMessage,color:this.alertType,position:this.alertPosition})},cancelAll:function(){var t=this;this.$buefy.dialog.confirm({title:"ยืนยันยกเลิกการเลือกบริษัท",message:"คุณมั่นใจว่าต้องการยกเลิกข้อมูลนี้",confirmText:"ยกเลิกข้อมูล",cancelText:"ย้อนกลับ",type:"danger",hasIcon:!0,onConfirm:function(){t.businessGroup=[]}})},cancelAllStock:function(){var t=this;this.$buefy.dialog.confirm({title:"ยืนยันยกเลิกการเลือกสินค้า",message:"คุณมั่นใจว่าต้องการยกเลิกข้อมูลนี้",confirmText:"ยกเลิกข้อมูล",cancelText:"ย้อนกลับ",type:"danger",hasIcon:!0,onConfirm:function(){t.stockGroup=[],t.currentAmount=[]}})},generate:function(){var t={content:[{columns:[{width:"50%",text:this.content.business_name},{width:"20%",text:this.content.business_invoice+"-"+this.content.business_invoice_number,alignment:"center"},{width:"30%",text:this.billCurrentDate,alignment:"right"}],columnGap:10},this.content.business_address,"เลขประจำตัวผู้เสียภาษีอากร "+this.content.business_tax,"\n",{layout:"lightHorizontalLines",table:{widths:["*","auto","auto","auto","auto"],body:this.currentData}},"\n",{columns:[{width:"90%",text:""},{width:"10%",text:parseFloat(this.currentBillPrice).toFixed(2),alignment:"right"}],columnGap:10},"\n",{columns:[{width:"60%",text:""},{width:"20%",text:"Vat 7%",alignment:"right"},{width:"20%",text:parseFloat(.07*parseFloat(this.currentBillPrice).toFixed(2)).toFixed(2),alignment:"right"}],columnGap:10},"\n",{columns:[{width:"80%",text:a(parseFloat(this.currentBillPrice-.07*this.currentBillPrice).toFixed(2))},{width:"20%",text:parseFloat(this.currentBillPrice-.07*this.currentBillPrice).toFixed(2),alignment:"right"}],columnGap:10}],defaultStyle:{font:"Kanit"}};r.createPdf(t).download("bill_"+this.content.business_invoice+"-"+this.content.business_invoice_number+".pdf")}},mounted:function(){this.getBusinessAsyncData(),this.getStockAsyncData()}},u=c,h=s("2877"),p=Object(h["a"])(u,i,n,!1,null,null,null);e["default"]=p.exports}}]);
//# sourceMappingURL=chunk-2d0b5da5.3277f5e2.js.map